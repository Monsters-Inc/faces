This job can be monitored from: https://scruffy.c3se.chalmers.se/d/alvis-job/alvis-job?var-jobid=71725&from=1621361653000
> Modules loaded
> Running train_model.py 1 times
2021-05-18 20:14:14.737092: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
['gray', 'he']
Traceback (most recent call last):
  File "train_model.py", line 52, in <module>
    X_test, y_test, age_model = age()
  File "train_model.py", line 41, in age
    X_train, X_test, y_train, y_test = data_age(dataset, full_dataset_folder, equal, img_shape, test_size, preprocessing, logging)
  File "/cephyr/users/gablindg/Alvis/faces/model/data.py", line 51, in data_age
    train_images = get_images(X_train, image_folder, image_shape, preprocessing, logging)
  File "/cephyr/users/gablindg/Alvis/faces/model/data.py", line 24, in get_images
    temp = preprocess([temp], image_shape, preprocessing)
  File "/cephyr/users/gablindg/Alvis/faces/model/data.py", line 172, in preprocess
    faces[i]=he_single(faces[i])
  File "/cephyr/users/gablindg/Alvis/faces/model/preprocessing_tools.py", line 338, in he_single
    he_img = cv2.equalizeHist(img)
cv2.error: OpenCV(4.2.0) /local/EB/build/OpenCV/4.2.0/fosscuda-2019b-Python-3.7.4/opencv-4.2.0/modules/imgproc/src/histogram.cpp:3439: error: (-215:Assertion failed) _src.type() == CV_8UC1 in function 'equalizeHist'

2021-05-18 20:14:17.910628: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2021-05-18 20:16:30.644154: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-05-18 20:16:30.683441: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:61:00.0 name: NVIDIA Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-05-18 20:16:30.683485: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2021-05-18 20:16:30.683533: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-05-18 20:16:30.683550: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-05-18 20:16:30.684473: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-05-18 20:16:30.686752: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-05-18 20:16:30.687818: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-05-18 20:16:30.691538: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-05-18 20:16:30.693109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2021-05-18 20:16:30.696096: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:61:00.0 name: NVIDIA Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-05-18 20:16:30.696120: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2021-05-18 20:16:30.696136: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-05-18 20:16:30.696144: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-05-18 20:16:30.696157: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-05-18 20:16:30.696166: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-05-18 20:16:30.696179: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-05-18 20:16:30.696188: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-05-18 20:16:30.697660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2021-05-18 20:16:30.697685: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2021-05-18 20:16:31.015245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-18 20:16:31.015292: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2021-05-18 20:16:31.015297: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2021-05-18 20:16:31.017776: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 30168 MB memory) -> physical GPU (device: 0, name: NVIDIA Tesla V100-SXM2-32GB, pci bus id: 0000:61:00.0, compute capability: 7.0)
2021-05-18 20:16:31.018033: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:Model was constructed with shape (None, 96, 96, 1) for input Tensor("input_1:0", shape=(None, 96, 96, 1), dtype=float32), but it was called on an input with incompatible shape (None, 96, 96, 3).
['gray']
hej
Epoch 1/300
Traceback (most recent call last):
  File "train_model.py", line 52, in <module>
    X_test, y_test, age_model = age()
  File "train_model.py", line 42, in age
    return X_test, y_test, train_age_model(X_train, X_test, y_train, y_test, img_shape, batch_size, epochs, augumentation, age_model_save, monitor)
  File "/cephyr/users/gablindg/Alvis/faces/model/age_model.py", line 68, in train_age_model
    model.fit(X_train, y_train, epochs=epochs, batch_size=batch_size, validation_data=(X_test, y_test), callbacks=[callback_list])
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 66, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 848, in fit
    tmp_logs = train_function(iterator)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 506, in _initialize
    *args, **kwds))
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 2667, in _create_graph_function
    capture_by_value=self._capture_by_value),
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: in user code:

    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:571 train_function  *
        outputs = self.distribute_strategy.run(
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:951 run  **
        return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:2290 call_for_each_replica
        return self._call_for_each_replica(fn, args, kwargs)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:2649 _call_for_each_replica
        return fn(*args, **kwargs)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:531 train_step  **
        y_pred = self(x, training=True)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py:927 __call__
        outputs = call_fn(cast_inputs, *args, **kwargs)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py:719 call
        convert_kwargs_to_constants=base_layer_utils.call_context().saving)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py:888 _run_internal_graph
        output_tensors = layer(computed_tensors, **kwargs)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py:886 __call__
        self.name)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/input_spec.py:216 assert_input_compatibility
        ' but received input with shape ' + str(shape))

    ValueError: Input 0 of layer conv2d is incompatible with the layer: expected axis -1 of input shape to have value 1 but received input with shape [None, 96, 96, 3]

2021-05-18 20:16:32.917114: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2021-05-18 20:16:51.044354: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcuda.so.1
2021-05-18 20:16:51.075882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:61:00.0 name: NVIDIA Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-05-18 20:16:51.075925: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2021-05-18 20:16:51.075976: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-05-18 20:16:51.075992: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-05-18 20:16:51.076789: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-05-18 20:16:51.078964: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-05-18 20:16:51.079917: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-05-18 20:16:51.083554: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-05-18 20:16:51.085125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2021-05-18 20:16:51.088143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1561] Found device 0 with properties: 
pciBusID: 0000:61:00.0 name: NVIDIA Tesla V100-SXM2-32GB computeCapability: 7.0
coreClock: 1.53GHz coreCount: 80 deviceMemorySize: 31.75GiB deviceMemoryBandwidth: 836.37GiB/s
2021-05-18 20:16:51.088165: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2021-05-18 20:16:51.088180: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcublas.so.10
2021-05-18 20:16:51.088187: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcufft.so.10
2021-05-18 20:16:51.088200: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcurand.so.10
2021-05-18 20:16:51.088210: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusolver.so.10
2021-05-18 20:16:51.088219: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcusparse.so.10
2021-05-18 20:16:51.088228: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudnn.so.7
2021-05-18 20:16:51.089696: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1703] Adding visible gpu devices: 0
2021-05-18 20:16:51.089720: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
2021-05-18 20:16:51.409032: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1102] Device interconnect StreamExecutor with strength 1 edge matrix:
2021-05-18 20:16:51.409077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1108]      0 
2021-05-18 20:16:51.409082: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1121] 0:   N 
2021-05-18 20:16:51.411580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1247] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 30168 MB memory) -> physical GPU (device: 0, name: NVIDIA Tesla V100-SXM2-32GB, pci bus id: 0000:61:00.0, compute capability: 7.0)
2021-05-18 20:16:51.411839: I tensorflow/core/common_runtime/process_util.cc:147] Creating new thread pool with default inter op setting: 2. Tune using inter_op_parallelism_threads for best performance.
WARNING:tensorflow:Model was constructed with shape (None, 96, 96, 1) for input Tensor("input_1:0", shape=(None, 96, 96, 1), dtype=float32), but it was called on an input with incompatible shape (None, 96, 96, 3).
['gray', 'median']
hej
Epoch 1/300
Traceback (most recent call last):
  File "train_model.py", line 52, in <module>
    X_test, y_test, age_model = age()
  File "train_model.py", line 42, in age
    return X_test, y_test, train_age_model(X_train, X_test, y_train, y_test, img_shape, batch_size, epochs, augumentation, age_model_save, monitor)
  File "/cephyr/users/gablindg/Alvis/faces/model/age_model.py", line 68, in train_age_model
    model.fit(X_train, y_train, epochs=epochs, batch_size=batch_size, validation_data=(X_test, y_test), callbacks=[callback_list])
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 66, in _method_wrapper
    return method(self, *args, **kwargs)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py", line 848, in fit
    tmp_logs = train_function(iterator)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 580, in __call__
    result = self._call(*args, **kwds)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 627, in _call
    self._initialize(args, kwds, add_initializers_to=initializers)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 506, in _initialize
    *args, **kwds))
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 2446, in _get_concrete_function_internal_garbage_collected
    graph_function, _, _ = self._maybe_define_function(args, kwargs)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 2777, in _maybe_define_function
    graph_function = self._create_graph_function(args, kwargs)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/function.py", line 2667, in _create_graph_function
    capture_by_value=self._capture_by_value),
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/func_graph.py", line 981, in func_graph_from_py_func
    func_outputs = python_func(*func_args, **func_kwargs)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/eager/def_function.py", line 441, in wrapped_fn
    return weak_wrapped_fn().__wrapped__(*args, **kwds)
  File "/apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/framework/func_graph.py", line 968, in wrapper
    raise e.ag_error_metadata.to_exception(e)
ValueError: in user code:

    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:571 train_function  *
        outputs = self.distribute_strategy.run(
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:951 run  **
        return self._extended.call_for_each_replica(fn, args=args, kwargs=kwargs)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:2290 call_for_each_replica
        return self._call_for_each_replica(fn, args, kwargs)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/distribute/distribute_lib.py:2649 _call_for_each_replica
        return fn(*args, **kwargs)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/training.py:531 train_step  **
        y_pred = self(x, training=True)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py:927 __call__
        outputs = call_fn(cast_inputs, *args, **kwargs)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py:719 call
        convert_kwargs_to_constants=base_layer_utils.call_context().saving)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/network.py:888 _run_internal_graph
        output_tensors = layer(computed_tensors, **kwargs)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/base_layer.py:886 __call__
        self.name)
    /apps/Alvis/software/MPI/GCC-CUDA/8.3.0-10.1.243/OpenMPI/3.1.4/TensorFlow/2.2.0-Python-3.7.4/lib/python3.7/site-packages/tensorflow/python/keras/engine/input_spec.py:216 assert_input_compatibility
        ' but received input with shape ' + str(shape))

    ValueError: Input 0 of layer conv2d is incompatible with the layer: expected axis -1 of input shape to have value 1 but received input with shape [None, 96, 96, 3]

2021-05-18 20:16:53.318471: I tensorflow/stream_executor/platform/default/dso_loader.cc:44] Successfully opened dynamic library libcudart.so.10.1
['gray', 'canny']
Traceback (most recent call last):
  File "train_model.py", line 52, in <module>
    X_test, y_test, age_model = age()
  File "train_model.py", line 41, in age
    X_train, X_test, y_train, y_test = data_age(dataset, full_dataset_folder, equal, img_shape, test_size, preprocessing, logging)
  File "/cephyr/users/gablindg/Alvis/faces/model/data.py", line 51, in data_age
    train_images = get_images(X_train, image_folder, image_shape, preprocessing, logging)
  File "/cephyr/users/gablindg/Alvis/faces/model/data.py", line 24, in get_images
    temp = preprocess([temp], image_shape, preprocessing)
  File "/cephyr/users/gablindg/Alvis/faces/model/data.py", line 178, in preprocess
    faces[i]=canny_edges_single(faces[i])
  File "/cephyr/users/gablindg/Alvis/faces/model/preprocessing_tools.py", line 430, in canny_edges_single
    height, width = img.shape
ValueError: too many values to unpack (expected 2)
